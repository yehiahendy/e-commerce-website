{"ast":null,"code":"var _jsxFileName = \"D:\\\\Work\\\\Zag System summer Training\\\\e-commerce-website\\\\e-commerce-forntend\\\\src\\\\admin\\\\UpdateProduct.jsx\",\n    _s = $RefreshSig$();\n\nimport React, { useState, useEffect } from 'react';\nimport Layout from '../core/Layout';\nimport { isAuthenticate } from '../auth';\nimport { Link, Redirect } from 'react-router-dom';\nimport { getProduct, getCategories, updateProduct } from './apiAdmin';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\n\nconst UpdateProduct = ({\n  match\n}) => {\n  _s();\n\n  const [values, setValues] = useState({\n    name: '',\n    description: '',\n    price: '',\n    categories: [],\n    category: '',\n    shipping: '',\n    quantity: '',\n    photo: '',\n    loading: false,\n    error: false,\n    createdProduct: '',\n    redirectToProfile: false,\n    formData: ''\n  });\n  const [categories, setCategories] = useState([]);\n  const {\n    user,\n    token\n  } = isAuthenticate();\n  const {\n    name,\n    description,\n    price,\n    // categories,\n    category,\n    shipping,\n    quantity,\n    loading,\n    error,\n    createdProduct,\n    redirectToProfile,\n    formData\n  } = values;\n\n  const init = productId => {\n    getProduct(productId).then(data => {\n      if (data.error) {\n        setValues({ ...values,\n          error: data.error\n        });\n      } else {\n        // populate the state\n        setValues({ ...values,\n          name: data.name,\n          description: data.description,\n          price: data.price,\n          category: data.category._id,\n          shipping: data.shipping,\n          quantity: data.quantity,\n          formData: new FormData()\n        }); // load categories\n\n        initCategories();\n      }\n    });\n  }; // load categories and set form data\n\n\n  const initCategories = () => {\n    getCategories().then(data => {\n      if (data.error) {\n        setValues({ ...values,\n          error: data.error\n        });\n      } else {\n        setCategories(data);\n      }\n    });\n  };\n\n  useEffect(() => {\n    init(match.params.productId);\n  }, []);\n\n  const handleChange = name => event => {\n    const value = name === 'photo' ? event.target.files[0] : event.target.value;\n    formData.set(name, value);\n    setValues({ ...values,\n      [name]: value\n    });\n  };\n\n  const clickSubmit = event => {\n    event.preventDefault();\n    setValues({ ...values,\n      error: '',\n      loading: true\n    });\n    updateProduct(match.params.productId, user._id, token, formData).then(data => {\n      if (data.error) {\n        setValues({ ...values,\n          error: data.error\n        });\n      } else {\n        setValues({ ...values,\n          name: '',\n          description: '',\n          photo: '',\n          price: '',\n          quantity: '',\n          loading: false,\n          error: false,\n          redirectToProfile: true,\n          createdProduct: data.name\n        });\n      }\n    });\n  };\n\n  const newPostForm = () => /*#__PURE__*/_jsxDEV(\"form\", {\n    className: \"mb-3\",\n    onSubmit: clickSubmit,\n    children: [/*#__PURE__*/_jsxDEV(\"h4\", {\n      children: \"Post Photo\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 110,\n      columnNumber: 13\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"form-group\",\n      children: /*#__PURE__*/_jsxDEV(\"label\", {\n        className: \"btn btn-secondary\",\n        children: /*#__PURE__*/_jsxDEV(\"input\", {\n          onChange: handleChange('photo'),\n          type: \"file\",\n          name: \"photo\",\n          accept: \"image/*\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 113,\n          columnNumber: 21\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 112,\n        columnNumber: 17\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 111,\n      columnNumber: 13\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"form-group\",\n      children: [/*#__PURE__*/_jsxDEV(\"label\", {\n        className: \"text-muted\",\n        children: \"Name\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 118,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n        onChange: handleChange('name'),\n        type: \"text\",\n        className: \"form-control\",\n        value: name\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 119,\n        columnNumber: 17\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 117,\n      columnNumber: 13\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"form-group\",\n      children: [/*#__PURE__*/_jsxDEV(\"label\", {\n        className: \"text-muted\",\n        children: \"Description\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 123,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(\"textarea\", {\n        onChange: handleChange('description'),\n        className: \"form-control\",\n        value: description\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 124,\n        columnNumber: 17\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 122,\n      columnNumber: 13\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"form-group\",\n      children: [/*#__PURE__*/_jsxDEV(\"label\", {\n        className: \"text-muted\",\n        children: \"Price\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 128,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n        onChange: handleChange('price'),\n        type: \"number\",\n        className: \"form-control\",\n        value: price\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 129,\n        columnNumber: 17\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 127,\n      columnNumber: 13\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"form-group\",\n      children: [/*#__PURE__*/_jsxDEV(\"label\", {\n        className: \"text-muted\",\n        children: \"Category\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 133,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(\"select\", {\n        onChange: handleChange('category'),\n        className: \"form-control\",\n        children: [/*#__PURE__*/_jsxDEV(\"option\", {\n          children: \"Please select\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 135,\n          columnNumber: 21\n        }, this), categories && categories.map((c, i) => /*#__PURE__*/_jsxDEV(\"option\", {\n          value: c._id,\n          children: c.name\n        }, i, false, {\n          fileName: _jsxFileName,\n          lineNumber: 138,\n          columnNumber: 29\n        }, this))]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 134,\n        columnNumber: 17\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 132,\n      columnNumber: 13\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"form-group\",\n      children: [/*#__PURE__*/_jsxDEV(\"label\", {\n        className: \"text-muted\",\n        children: \"Shipping\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 146,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(\"select\", {\n        onChange: handleChange('shipping'),\n        className: \"form-control\",\n        children: [/*#__PURE__*/_jsxDEV(\"option\", {\n          children: \"Please select\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 148,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(\"option\", {\n          value: \"0\",\n          children: \"No\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 149,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(\"option\", {\n          value: \"1\",\n          children: \"Yes\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 150,\n          columnNumber: 21\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 147,\n        columnNumber: 17\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 145,\n      columnNumber: 13\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"form-group\",\n      children: [/*#__PURE__*/_jsxDEV(\"label\", {\n        className: \"text-muted\",\n        children: \"Quantity\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 155,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n        onChange: handleChange('quantity'),\n        type: \"number\",\n        className: \"form-control\",\n        value: quantity\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 156,\n        columnNumber: 17\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 154,\n      columnNumber: 13\n    }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n      className: \"btn btn-outline-primary\",\n      children: \"Update Product\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 159,\n      columnNumber: 13\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 109,\n    columnNumber: 9\n  }, this);\n\n  const showError = () => /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"alert alert-danger\",\n    style: {\n      display: error ? '' : 'none'\n    },\n    children: error\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 164,\n    columnNumber: 9\n  }, this);\n\n  const showSuccess = () => /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"alert alert-info\",\n    style: {\n      display: createdProduct ? '' : 'none'\n    },\n    children: /*#__PURE__*/_jsxDEV(\"h2\", {\n      children: [`${createdProduct}`, \" is updated!\"]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 171,\n      columnNumber: 13\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 170,\n    columnNumber: 9\n  }, this);\n\n  const showLoading = () => loading && /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"alert alert-success\",\n    children: /*#__PURE__*/_jsxDEV(\"h2\", {\n      children: \"Loading...\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 178,\n      columnNumber: 17\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 177,\n    columnNumber: 13\n  }, this);\n\n  const redirectUser = () => {\n    if (redirectToProfile) {\n      if (!error) {\n        return /*#__PURE__*/_jsxDEV(Redirect, {\n          to: \"/\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 185,\n          columnNumber: 24\n        }, this);\n      }\n    }\n  };\n\n  return /*#__PURE__*/_jsxDEV(Layout, {\n    title: \"Add a new product\",\n    description: `G'day ${user.name}, ready to add a new product?`,\n    children: /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"row\",\n      children: /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"col-md-8 offset-md-2\",\n        children: [showLoading(), showSuccess(), showError(), newPostForm(), redirectUser()]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 193,\n        columnNumber: 17\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 192,\n      columnNumber: 13\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 191,\n    columnNumber: 9\n  }, this);\n};\n\n_s(UpdateProduct, \"6frnu/576ozSoOwvjSDmKc+Ukbs=\");\n\n_c = UpdateProduct;\nexport default UpdateProduct;\n\nvar _c;\n\n$RefreshReg$(_c, \"UpdateProduct\");","map":{"version":3,"sources":["D:/Work/Zag System summer Training/e-commerce-website/e-commerce-forntend/src/admin/UpdateProduct.jsx"],"names":["React","useState","useEffect","Layout","isAuthenticate","Link","Redirect","getProduct","getCategories","updateProduct","UpdateProduct","match","values","setValues","name","description","price","categories","category","shipping","quantity","photo","loading","error","createdProduct","redirectToProfile","formData","setCategories","user","token","init","productId","then","data","_id","FormData","initCategories","params","handleChange","event","value","target","files","set","clickSubmit","preventDefault","newPostForm","map","c","i","showError","display","showSuccess","showLoading","redirectUser"],"mappings":"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","sourcesContent":["import React, { useState, useEffect } from 'react';\r\nimport Layout from '../core/Layout';\r\nimport { isAuthenticate } from '../auth';\r\nimport { Link, Redirect } from 'react-router-dom';\r\nimport { getProduct, getCategories, updateProduct } from './apiAdmin';\r\n\r\nconst UpdateProduct = ({ match }) => {\r\n    const [values, setValues] = useState({\r\n        name: '',\r\n        description: '',\r\n        price: '',\r\n        categories: [],\r\n        category: '',\r\n        shipping: '',\r\n        quantity: '',\r\n        photo: '',\r\n        loading: false,\r\n        error: false,\r\n        createdProduct: '',\r\n        redirectToProfile: false,\r\n        formData: ''\r\n    });\r\n    const [categories, setCategories] = useState([]);\r\n\r\n    const { user, token } = isAuthenticate();\r\n    const {\r\n        name,\r\n        description,\r\n        price,\r\n        // categories,\r\n        category,\r\n        shipping,\r\n        quantity,\r\n        loading,\r\n        error,\r\n        createdProduct,\r\n        redirectToProfile,\r\n        formData\r\n    } = values;\r\n\r\n    const init = productId => {\r\n        getProduct(productId).then(data => {\r\n            if (data.error) {\r\n                setValues({ ...values, error: data.error });\r\n            } else {\r\n                // populate the state\r\n                setValues({\r\n                    ...values,\r\n                    name: data.name,\r\n                    description: data.description,\r\n                    price: data.price,\r\n                    category: data.category._id,\r\n                    shipping: data.shipping,\r\n                    quantity: data.quantity,\r\n                    formData: new FormData()\r\n                });\r\n                // load categories\r\n                initCategories();\r\n            }\r\n        });\r\n    };\r\n\r\n    // load categories and set form data\r\n    const initCategories = () => {\r\n        getCategories().then(data => {\r\n            if (data.error) {\r\n                setValues({ ...values, error: data.error });\r\n            } else {\r\n                setCategories(data);\r\n            }\r\n        });\r\n    };\r\n\r\n    useEffect(() => {\r\n        init(match.params.productId);\r\n    }, []);\r\n\r\n    const handleChange = name => event => {\r\n        const value = name === 'photo' ? event.target.files[0] : event.target.value;\r\n        formData.set(name, value);\r\n        setValues({ ...values, [name]: value });\r\n    };\r\n\r\n    const clickSubmit = event => {\r\n        event.preventDefault();\r\n        setValues({ ...values, error: '', loading: true });\r\n\r\n        updateProduct(match.params.productId, user._id, token, formData).then(data => {\r\n            if (data.error) {\r\n                setValues({ ...values, error: data.error });\r\n            } else {\r\n                setValues({\r\n                    ...values,\r\n                    name: '',\r\n                    description: '',\r\n                    photo: '',\r\n                    price: '',\r\n                    quantity: '',\r\n                    loading: false,\r\n                    error: false,\r\n                    redirectToProfile: true,\r\n                    createdProduct: data.name\r\n                });\r\n            }\r\n        });\r\n    };\r\n\r\n    const newPostForm = () => (\r\n        <form className=\"mb-3\" onSubmit={clickSubmit}>\r\n            <h4>Post Photo</h4>\r\n            <div className=\"form-group\">\r\n                <label className=\"btn btn-secondary\">\r\n                    <input onChange={handleChange('photo')} type=\"file\" name=\"photo\" accept=\"image/*\" />\r\n                </label>\r\n            </div>\r\n\r\n            <div className=\"form-group\">\r\n                <label className=\"text-muted\">Name</label>\r\n                <input onChange={handleChange('name')} type=\"text\" className=\"form-control\" value={name} />\r\n            </div>\r\n\r\n            <div className=\"form-group\">\r\n                <label className=\"text-muted\">Description</label>\r\n                <textarea onChange={handleChange('description')} className=\"form-control\" value={description} />\r\n            </div>\r\n\r\n            <div className=\"form-group\">\r\n                <label className=\"text-muted\">Price</label>\r\n                <input onChange={handleChange('price')} type=\"number\" className=\"form-control\" value={price} />\r\n            </div>\r\n\r\n            <div className=\"form-group\">\r\n                <label className=\"text-muted\">Category</label>\r\n                <select onChange={handleChange('category')} className=\"form-control\">\r\n                    <option>Please select</option>\r\n                    {categories &&\r\n                        categories.map((c, i) => (\r\n                            <option key={i} value={c._id}>\r\n                                {c.name}\r\n                            </option>\r\n                        ))}\r\n                </select>\r\n            </div>\r\n\r\n            <div className=\"form-group\">\r\n                <label className=\"text-muted\">Shipping</label>\r\n                <select onChange={handleChange('shipping')} className=\"form-control\">\r\n                    <option>Please select</option>\r\n                    <option value=\"0\">No</option>\r\n                    <option value=\"1\">Yes</option>\r\n                </select>\r\n            </div>\r\n\r\n            <div className=\"form-group\">\r\n                <label className=\"text-muted\">Quantity</label>\r\n                <input onChange={handleChange('quantity')} type=\"number\" className=\"form-control\" value={quantity} />\r\n            </div>\r\n\r\n            <button className=\"btn btn-outline-primary\">Update Product</button>\r\n        </form>\r\n    );\r\n\r\n    const showError = () => (\r\n        <div className=\"alert alert-danger\" style={{ display: error ? '' : 'none' }}>\r\n            {error}\r\n        </div>\r\n    );\r\n\r\n    const showSuccess = () => (\r\n        <div className=\"alert alert-info\" style={{ display: createdProduct ? '' : 'none' }}>\r\n            <h2>{`${createdProduct}`} is updated!</h2>\r\n        </div>\r\n    );\r\n\r\n    const showLoading = () =>\r\n        loading && (\r\n            <div className=\"alert alert-success\">\r\n                <h2>Loading...</h2>\r\n            </div>\r\n        );\r\n\r\n    const redirectUser = () => {\r\n        if (redirectToProfile) {\r\n            if (!error) {\r\n                return <Redirect to=\"/\" />;\r\n            }\r\n        }\r\n    };\r\n\r\n    return (\r\n        <Layout title=\"Add a new product\" description={`G'day ${user.name}, ready to add a new product?`}>\r\n            <div className=\"row\">\r\n                <div className=\"col-md-8 offset-md-2\">\r\n                    {showLoading()}\r\n                    {showSuccess()}\r\n                    {showError()}\r\n                    {newPostForm()}\r\n                    {redirectUser()}\r\n                </div>\r\n            </div>\r\n        </Layout>\r\n    );\r\n};\r\n\r\nexport default UpdateProduct;"]},"metadata":{},"sourceType":"module"}